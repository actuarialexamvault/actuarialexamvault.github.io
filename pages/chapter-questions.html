<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chapter Questions - ExamVault</title>
    <link rel="stylesheet" href="../css/progress-tracker-styles.css">
    <!-- Load theme immediately to prevent flash -->
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || localStorage.getItem('userTheme') || 'light';
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
            // Set initial logo based on theme
            window.addEventListener('DOMContentLoaded', function() {
                const logoImages = document.querySelectorAll('.logo-icon');
                const logoSrc = theme === 'dark' ? '../favicon.svg' : '../favicon-light.svg';
                logoImages.forEach(img => img.src = logoSrc);
            });
        })();
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="dashboard.html" class="logo">
                <img src="../favicon-light.svg" alt="ExamVault Logo" class="logo-icon">
                <span class="logo-text"><span class="logo-exam">Exam</span><span class="logo-vault">Vault</span></span>
            </a>
            <div class="nav-links">
                <a href="dashboard.html" class="nav-link">HOME</a>
                <a href="acount.html" class="nav-link">ACCOUNT</a>
                <button class="btn-signout-nav" id="signOutBtn">SIGN OUT</button>
            </div>
        </div>
    </nav>

    <main class="subjects-container">
        <div class="subjects-header">
            <h1 id="pageTitle">Chapter Questions</h1>
            <p id="subTitle" style="color:#666;">Select a question to practice.</p>
        </div>

        <div id="questionsContainer" class="subjects-list">
            <!-- Topic overview (kept for legacy) -->
        </div>

        <div class="content-header">
            <h1 id="subjectChapterTitle">Questions for chapter</h1>
            <p id="subTitle" style="color:#666; text-align:center;">Select a question to practice. Track progress and improve your performance on this topic</p>
        </div>
        


        <!-- Questions Detail View -->
        <div class="page-container" id="questionsView">
            <main class="main-content">
                <!-- Performance Over Time Section -->
                <div class="performance-graph-section" id="performanceGraphSection" style="display: none;">
                    <div class="progress-stats">
                        <div class="stat-item">
                            <span class="stat-value" id="chapterAttemptedCount">0</span>
                            <span class="stat-label">Attempted</span>
                        </div>
                        <div class="stat-divider">/</div>
                        <div class="stat-item">
                            <span class="stat-value" id="chapterTotalCount">0</span>
                            <span class="stat-label">Total Available</span>
                        </div>
                    </div>
                    <div class="line-graph-container compact">
                        <canvas id="performanceLineGraph"></canvas>
                    </div>
                    <p class="section-description" style="text-align: center;">Track your improvement for this chapter across multiple attempts</p>
                </div>

                <!-- Performance Statistics Table -->
                <div class="performance-stats-section" id="performanceStatsSection" style="display: none; max-width: 1400px; margin: 2rem auto 1rem auto;">
                    <h2 class="stats-title">Overall Attempt History & Performance</h2>
                    <div class="stats-table-container">
                        <table class="stats-table">
                            <thead>
                                <tr>
                                    <th>REVIEW TYPE</th>
                                    <th>QUESTIONS</th>
                                    <th>POSSIBLE MARKS</th>
                                    <th>SCORED MARKS</th>
                                    <th>PERFORMANCE</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <span class="review-type-indicator self"></span>
                                        <span>Self-reviewed</span>
                                    </td>
                                    <td id="selfQuestionsCount">0</td>
                                    <td id="selfPossibleMarks">0</td>
                                    <td id="selfScoredMarks">0</td>
                                    <td>
                                        <span class="performance-badge" id="selfPerformance">0%</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span class="review-type-indicator ai"></span>
                                        <span>AI-reviewed</span>
                                    </td>
                                    <td id="aiQuestionsCount">0</td>
                                    <td id="aiPossibleMarks">0</td>
                                    <td id="aiScoredMarks">0</td>
                                    <td>
                                        <span class="performance-badge" id="aiPerformance">0%</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Attempted Questions Section -->
                <div class="papers-section">
                    <div class="section-header" id="attemptedHeader">
                        <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <h2>Attempted Questions</h2>
                        <span class="section-count" id="attemptedQuestionsCount">0</span>
                    </div>
                    <div class="papers-list" id="attemptedList">
                        <!-- Attempted questions go here -->
                    </div>
                </div>

                <!-- Available Questions Section -->
                <div class="papers-section">
                    <div class="section-header" id="notAttemptedHeader">
                        <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <h2>Available Questions</h2>
                        <span class="section-count" id="notAttemptedQuestionsCount">0</span>
                    </div>
                    <div class="papers-list" id="notAttemptedList">
                        <!-- Not attempted questions go here -->
                    </div>
                </div>

                
                <button class="btn-back-bottom" id="backBtn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Back to Chapters
                </button>
            </main>
        </div>
    </main>

    <!-- Review Type Selection Modal -->
    <div id="reviewTypeModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-icon info">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 8V12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="12" cy="16" r="1" fill="currentColor"/>
                </svg>
            </div>
            <h2>Choose Review Type</h2>
            <p>How would you like to review this question?</p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" id="selfReviewBtn">Self-Review</button>
                <button class="modal-btn modal-btn-secondary" id="aiReviewBtn">AI-Review</button>
            </div>
        </div>
    </div>

    <!-- AI Review Instructions Modal -->
    <div id="aiInstructionsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content ai-instructions">
            <div class="modal-icon success">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h2>AI Review Instructions</h2>
            <p>Use your preferred AI tool (ChatGPT, Claude, Gemini etc.) with the following prompt:</p>
            
            <div class="prompt-container">
                <textarea id="aiPromptText" readonly style="height: 400px;">Loading prompt...</textarea>
            </div>

            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" id="copyPromptBtn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 20px; height: 20px; margin-right: 8px;">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M5 15H4C3.46957 15 2.96086 14.7893 2.58579 14.4142C2.21071 14.0391 2 13.5304 2 13V4C2 3.46957 2.21071 2.96086 2.58579 2.58579C2.96086 2.21071 3.46957 2 4 2H13C13.5304 2 14.0391 2.21071 14.4142 2.58579C14.7893 2.96086 15 3.46957 15 4V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Copy Prompt
                </button>
                <button class="modal-btn modal-btn-secondary" id="closeAiInstructionsBtn">Close & Continue</button>
            </div>
        </div>
    </div>

    <!-- Load Chart.js and DataLabels plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    
    <script type="module" src="../js/chapter-questions-script.js"></script>
</body>
</html>